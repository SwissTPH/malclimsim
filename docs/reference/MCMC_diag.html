<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>MCMC Diagnostics — MCMC_diag • malclimsim</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="MCMC Diagnostics — MCMC_diag"><meta name="description" content="Provides diagnostic information for MCMC results, including trace plots,
chain convergence statistics, correlation structure, effective sample size,
autocorrelation function, posterior quantiles, and acceptance rates.
Designed for users to assess MCMC chain convergence and parameter mixing.
Computes and optionally plots a suite of MCMC diagnostics including trace plots, Gelman-Rubin statistics,
autocorrelation, effective sample size, and posterior quantiles."><meta property="og:description" content="Provides diagnostic information for MCMC results, including trace plots,
chain convergence statistics, correlation structure, effective sample size,
autocorrelation function, posterior quantiles, and acceptance rates.
Designed for users to assess MCMC chain convergence and parameter mixing.
Computes and optionally plots a suite of MCMC diagnostics including trace plots, Gelman-Rubin statistics,
autocorrelation, effective sample size, and posterior quantiles."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">malclimsim</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/using-malclimsim.html">Using malclimsim to infer parameters of a climate-driven dynamical transmission model</a></li>
    <li><a class="dropdown-item" href="../articles/using-your-own-model.html">How to import a model for use with malclimsim</a></li>
    <li><a class="dropdown-item" href="../articles/viewing-and-modifying-observation-functions.html">Viewing and Modifying Observation Functions</a></li>
    <li><a class="dropdown-item" href="../articles/viewing-and-modifying-priors.html">Viewing and modifying priors</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nputney4/malclimsim/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>MCMC Diagnostics</h1>
      <small class="dont-index">Source: <a href="https://github.com/nputney4/malclimsim/blob/HEAD/R/inference_diagnostics.R" class="external-link"><code>R/inference_diagnostics.R</code></a></small>
      <div class="d-none name"><code>MCMC_diag.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Provides diagnostic information for MCMC results, including trace plots,
chain convergence statistics, correlation structure, effective sample size,
autocorrelation function, posterior quantiles, and acceptance rates.
Designed for users to assess MCMC chain convergence and parameter mixing.</p>
<p>Computes and optionally plots a suite of MCMC diagnostics including trace plots, Gelman-Rubin statistics,
autocorrelation, effective sample size, and posterior quantiles.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">MCMC_diag</span><span class="op">(</span></span>
<span>  <span class="va">results</span>,</span>
<span>  params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"trace"</span>, <span class="st">"gelman"</span>, <span class="st">"corr"</span>, <span class="st">"ess"</span>, <span class="st">"acf"</span>, <span class="st">"quantiles"</span>, <span class="st">"acceptance"</span><span class="op">)</span>,</span>
<span>  thin <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">MCMC_diag</span><span class="op">(</span></span>
<span>  <span class="va">results</span>,</span>
<span>  params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"trace"</span>, <span class="st">"gelman"</span>, <span class="st">"corr"</span>, <span class="st">"ess"</span>, <span class="st">"acf"</span>, <span class="st">"quantiles"</span>, <span class="st">"acceptance"</span><span class="op">)</span>,</span>
<span>  thin <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-results">results<a class="anchor" aria-label="anchor" href="#arg-results"></a></dt>
<dd><p>A fitted MCMC result object (e.g., from <code><a href="https://rdrr.io/pkg/mcstate/man/pmcmc.html" class="external-link">mcstate::pmcmc()</a></code>). Must contain a <code>pars</code> matrix and <code>n_chains</code> value.</p></dd>


<dt id="arg-params">params<a class="anchor" aria-label="anchor" href="#arg-params"></a></dt>
<dd><p>A character vector specifying which diagnostics to compute/plot. Options include:</p><ul><li><p><code>"trace"</code>: Trace plots of each parameter.</p></li>
<li><p><code>"gelman"</code>: Gelman-Rubin convergence diagnostics (requires <code>n_chains &gt; 1</code>).</p></li>
<li><p><code>"corr"</code>: Pairwise correlation plots (calls <code><a href="plot_corr.html">plot_corr()</a></code>).</p></li>
<li><p><code>"ess"</code>: Effective sample size.</p></li>
<li><p><code>"acf"</code>: Autocorrelation plots.</p></li>
<li><p><code>"quantiles"</code>: Posterior quantile summaries.</p></li>
<li><p><code>"acceptance"</code>: Acceptance rate (based on rejection rate).</p></li>
</ul></dd>


<dt id="arg-thin">thin<a class="anchor" aria-label="anchor" href="#arg-thin"></a></dt>
<dd><p>Integer; optional thinning interval. If greater than 1, chains are thinned accordingly. Default is 1 (no thinning).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Diagnostic outputs based on the selected <code>params</code> are printed or plotted.</p>
<p>A list containing the selected diagnostics. Output elements are named according to <code>params</code>, and may include:</p><ul><li><p><code>$trace</code>: The <code>mcmc.list</code> object used for plotting.</p></li>
<li><p><code>$gelman</code>: Output from <code>gelman.diag()</code>.</p></li>
<li><p><code>$corr</code>: Placeholder message indicating correlation plot was created.</p></li>
<li><p><code>$ess</code>: Effective sample sizes from <code>effectiveSize()</code>.</p></li>
<li><p><code>$acf</code>: Placeholder message indicating ACF was plotted.</p></li>
<li><p><code>$quantiles</code>: Matrix of posterior quantiles (2.5%, 50%, 97.5%).</p></li>
<li><p><code>$acceptance</code>: Acceptance rates per chain.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function wraps common diagnostics from the <code>coda</code> package and custom correlation plotting into a single call.
Useful for quickly assessing convergence and chain quality after MCMC sampling.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Assuming 'results' is a valid MCMC result list with required structure:</span></span></span>
<span class="r-in"><span><span class="fu">MCMC_diag</span><span class="op">(</span><span class="va">results</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"trace"</span>, <span class="st">"ess"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'results' not found</span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">diagnostics</span> <span class="op">&lt;-</span> <span class="fu">MCMC_diag</span><span class="op">(</span><span class="va">results</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"trace"</span>, <span class="st">"gelman"</span>, <span class="st">"ess"</span>, <span class="st">"quantiles"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nicholas Putney.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

