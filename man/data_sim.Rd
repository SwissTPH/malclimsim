% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/model_simulation.R
\name{data_sim}
\alias{data_sim}
\title{Simulate Incidence Data from the Model}
\usage{
data_sim(
  model,
  param_inputs,
  start_date,
  end_date,
  prewarm_years = 2,
  month = FALSE,
  round = TRUE,
  save = TRUE,
  file = "",
  month_unequal_days = FALSE,
  return_EIR = FALSE,
  return_compartments = FALSE,
  mu_transform_A = NULL,
  mu_transform_C = NULL,
  covariate_matrix = NULL
)
}
\arguments{
\item{model}{A dust model object used to simulate malaria transmission.}

\item{param_inputs}{A named list of model parameter values.}

\item{start_date}{Start date of the observation window (character or Date).}

\item{end_date}{End date of the observation window (character or Date).}

\item{prewarm_years}{Number of years to simulate before \code{start_date} for warm-up (default = 2).}

\item{month}{Logical. If \code{TRUE}, aggregate and return monthly incidence (default).}

\item{round}{Logical. If \code{TRUE}, round the incidence values to integers (default = TRUE).}

\item{save}{Logical. If \code{TRUE}, save the result as an RDS file.}

\item{file}{Character. Filename to use if saving to disk.}

\item{month_unequal_days}{Logical. If \code{TRUE}, aggregate based on actual month boundaries.}

\item{return_EIR}{Logical. If \code{TRUE}, include EIR values in the output.}

\item{return_compartments}{Logical. (Currently unused.)}

\item{mu_transform_A}{Optional function to transform adult incidence after simulation.}

\item{mu_transform_C}{Optional function to transform child incidence after simulation.}

\item{covariate_matrix}{Optional data frame of covariates to merge by date.}
}
\value{
A data frame with date, group-specific incidence (and optional transformed incidence).
}
\description{
Runs a deterministic model simulation and returns incidence data aggregated
either monthly or weekly. Allows for a warm-up period prior to the start date,
optional rounding, and optional transformations to incidence values (e.g., to apply
covariate effects used in observation models).
}
\examples{
# Simulate and apply a log-linear transformation to child incidence
mu_C_adj <- function(df, pars) exp(log(df$inc_C) + 0.1 * df$cov_SMC / 30)
sim_df <- data_sim(model, param_inputs, "2014-01-01", "2019-12-31",
                   mu_transform_C = mu_C_adj, covariate_matrix = covariates)
}
